# Amaç: RT-DETRv2 için pothole dataset tanımı ve augmentation pipeline'ı.
# Bağımlılıklar: RT-DETRv2 YAMLConfig loader
# Kullanım: 02_train.py içinden --config ile yüklenir.

__include__: []

# RT-DETRv2 kodunda bazı varyantlarda num_classes doğrudan sınıf sayısı, bazılarında background dahil okunur.
# Bu nedenle burada prompt gereği 2 kullanıldı: background + pothole.
num_classes: 2
remap_mscoco_category: False

train_dataloader:
  dataset:
    type: CocoDetection
    img_folder: /content/dataset/combined_dataset/images/train
    ann_file: /content/dataset/combined_dataset/annotations/train_annotations.json
    transforms:
      type: Compose
      ops:
        - {type: RandomPhotometricDistort}
        - {type: RandomZoomOut, fill: 0}
        - {type: RandomIoUCrop, p: 0.8}
        - {
            type: RandomHorizontalFlip,
            p: 0.5
          }
        # Küçük pothole kaçırmamak için geniş multi-scale aralığı kullanılır.
        - {
            type: RandomResize,
            sizes: [480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800],
            max_size: 1333
          }
        # Asfalt/ışık varyasyonu için color jitter.
        - {
            type: ColorJitter,
            brightness: 0.3,
            contrast: 0.3,
            saturation: 0.3,
            hue: 0.1
          }
        - {type: ConvertPILImage, dtype: float32, scale: True}
        - {type: ConvertBoxes, fmt: cxcywh, normalize: True}
  shuffle: True
  drop_last: True
  num_workers: 4
  batch_size: 32
  collate_fn:
    type: BatchImageCollateFunction
    scales: [480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800]

val_dataloader:
  dataset:
    type: CocoDetection
    img_folder: /content/dataset/combined_dataset/images/val
    ann_file: /content/dataset/combined_dataset/annotations/val_annotations.json
    transforms:
      type: Compose
      ops:
        - {type: Resize, size: [640, 640]}
        - {type: ConvertPILImage, dtype: float32, scale: True}
        - {type: ConvertBoxes, fmt: cxcywh, normalize: True}
  shuffle: False
  drop_last: False
  num_workers: 2
  batch_size: 32
  collate_fn:
    type: BatchImageCollateFunction
    scales: ~
